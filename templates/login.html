<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <div class="card" style="max-width: 420px; margin: 120px auto;">
            <h2>Login</h2>
            <p class="tagline">Sign in to continue</p>

            {% if error %}
                <p style="color:#f87171;">{{ error }}</p>
            {% endif %}

                            <div class="form-group">
                    <label>Email</label>
                    <input type="email" name="email" required>
                </div>

                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="password" required>
                </div>

                <button class="btn btn-primary" onclick="login()">Login</button>



            <p style="margin-top:15px;">
                Donâ€™t have an account?
                <a href="/register">Register</a>
            </p>
        </div>
    </div>


<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCtwxEAapVFBTKKXStjozkHhhOsyo0OOo0",
    authDomain: "second-thought-fe3e9.firebaseapp.com",
    projectId: "second-thought-fe3e9",
    storageBucket: "second-thought-fe3e9.firebasestorage.app",
    messagingSenderId: "732080603254",
    appId: "1:732080603254:web:f2dd0e62e882f1cec2df57",
    measurementId: "G-BDCPGH7EHX"
  };

  
  firebase.initializeApp(firebaseConfig);

  
  const auth = firebase.auth();
</script>


<script>
async function login() {
    const email = document.querySelector('[name=email]').value;
    const password = document.querySelector('[name=password]').value;

    if (!email || !password) {
        alert("Please fill in all fields");
        return;
    }

    try {
        const userCred = await auth.signInWithEmailAndPassword(email, password);
        const token = await userCred.user.getIdToken();

        await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            credentials: 'same-origin',
            body: JSON.stringify({ token })
        });

        window.location.href = "/";
    } catch (error) {
        alert(error.message);
    }
}
</script>



</body>
</html>